#!/bin/bash
# Bart CLI

BUN="${BUN:-bun}"

# Get the directory where this script is installed
if [ -L "${BASH_SOURCE[0]}" ]; then
    SCRIPT_PATH="$(readlink -f "${BASH_SOURCE[0]}")"
else
    SCRIPT_PATH="${BASH_SOURCE[0]}"
fi

# Find package root - go up from bin directory
PACKAGE_DIR="$(cd "$(dirname "$SCRIPT_PATH")/.." && pwd)"

# Verify package has src/index.ts, otherwise try npm root -g
if [ ! -f "$PACKAGE_DIR/src/index.ts" ]; then
    PACKAGE_DIR="$(npm root -g)/bart-loop"
fi

exec "$BUN" "$PACKAGE_DIR/src/index.ts" "$@"
